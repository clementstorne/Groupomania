{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-efac525c\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"profile container py-3 px-3 col-12 py-md-3 px-md-5 col-md-10\"\n};\nconst _hoisted_2 = {\n  class: \"profile-username text-center\"\n};\nconst _hoisted_3 = {\n  class: \"profile-picture d-flex flex-column justify-content-center align-items-center mt-3 mb-5\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = {\n  class: \"profile-picture-btn col-10 text-center\"\n};\n\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"btn btn-primary col-12 mt-3\"\n}, [/*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"profilePicture\"\n}, \"Modifier la photo de profil\")], -1\n/* HOISTED */\n));\n\nconst _hoisted_9 = {\n  class: \"profile-email mb-5 text-center\"\n};\nconst _hoisted_10 = {\n  class: \"mb-2\"\n};\nconst _hoisted_11 = {\n  for: \"email\",\n  class: \"form-label\"\n};\nconst _hoisted_12 = {\n  key: 1\n};\nconst _hoisted_13 = [\"placeholder\"];\nconst _hoisted_14 = {\n  class: \"profile-password mb-5 text-center\"\n};\nconst _hoisted_15 = {\n  class: \"mb-2\"\n};\nconst _hoisted_16 = {\n  for: \"password\",\n  class: \"form-label\"\n};\nconst _hoisted_17 = {\n  key: 1\n};\nconst _hoisted_18 = [\"disabled\"];\nconst _hoisted_19 = {\n  class: \"profile-delete mb-2\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_BlockAlert = _resolveComponent(\"BlockAlert\");\n\n  const _component_BlockConfirmation = _resolveComponent(\"BlockConfirmation\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"h2\", null, _toDisplayString($data.user.firstname) + \" \" + _toDisplayString($data.user.lastname), 1\n  /* TEXT */\n  )]), _createElementVNode(\"div\", _hoisted_3, [$data.imageBase64url ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 0,\n    src: $data.imageBase64url,\n    alt: \"Photo de profil de l'utilisateur\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_4)) : $data.user.imageUrl ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 1,\n    src: $data.user.imageUrl,\n    alt: \"Photo de profil de l'utilisateur\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_5)) : (_openBlock(), _createElementBlock(\"img\", {\n    key: 2,\n    src: $data.defautlImageUrl,\n    alt: \"Photo de profil de l'utilisateur\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_6)), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"input\", {\n    type: \"file\",\n    name: \"image\",\n    id: \"profilePicture\",\n    accept: \"image/png, image/jpg, image/jpeg\",\n    class: \"profile-picture-btn-input\",\n    onChange: _cache[0] || (_cache[0] = (...args) => $options.setBase64urlImage && $options.setBase64urlImage(...args))\n  }, null, 32\n  /* HYDRATE_EVENTS */\n  ), _hoisted_8])]), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"label\", _hoisted_11, [!$options.emailIsValid ? (_openBlock(), _createElementBlock(\"span\", {\n    key: 0,\n    class: \"form-alert\",\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.emailAlert && $options.emailAlert(...args))\n  }, \" ⚠️ \")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_12, \" ✅ \")), _createTextVNode(\"Email\")]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    class: \"form-control\",\n    id: \"email\",\n    placeholder: $data.user.email,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.user.email = $event)\n  }, null, 8\n  /* PROPS */\n  , _hoisted_13), [[_vModelText, $data.user.email]])])]), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"label\", _hoisted_16, [!$options.passwordIsValid ? (_openBlock(), _createElementBlock(\"span\", {\n    key: 0,\n    class: \"form-alert\",\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.passwordAlert && $options.passwordAlert(...args))\n  }, \" ⚠️ \")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_17, \" ✅ \")), _createTextVNode(\"Mot de passe\")]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    class: \"form-control\",\n    id: \"password\",\n    placeholder: \"********\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.user.password = $event)\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelText, $data.user.password]])])]), _createElementVNode(\"button\", {\n    class: \"btn btn-primary col-12 mb-3\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.updateProfile && $options.updateProfile(...args)),\n    disabled: !$options.formIsValid\n  }, \" Mettre à jour les informations \", 8\n  /* PROPS */\n  , _hoisted_18), _createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"button\", {\n    class: \"btn btn-secondary col-12\",\n    onClick: _cache[6] || (_cache[6] = (...args) => $options.showBlockConfirmation && $options.showBlockConfirmation(...args))\n  }, \" Supprimer le compte \")]), _createVNode(_component_BlockAlert, {\n    revealAlert: $data.revealAlert,\n    toggleAlert: $options.toggleAlert,\n    messageAlert: $data.messageAlert\n  }, null, 8\n  /* PROPS */\n  , [\"revealAlert\", \"toggleAlert\", \"messageAlert\"]), _createVNode(_component_BlockConfirmation, {\n    revealConfirmation: $data.revealConfirmation,\n    toggleConfirmation: $options.toggleConfirmation,\n    messageConfirmation: $data.messageConfirmation,\n    onAction: $options.deleteProfile\n  }, null, 8\n  /* PROPS */\n  , [\"revealConfirmation\", \"toggleConfirmation\", \"messageConfirmation\", \"onAction\"])]);\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","for","_createElementBlock","_toDisplayString","$data","firstname","lastname","src","alt","imageUrl","type","name","id","accept","onChange","$options","_hoisted_8","onClick","_hoisted_12","placeholder","email","$event","_hoisted_17","password","disabled","_hoisted_18","_createVNode","_component_BlockAlert","revealAlert","toggleAlert","messageAlert","_component_BlockConfirmation","revealConfirmation","toggleConfirmation","messageConfirmation","onAction"],"sourceRoot":"","sources":["/Users/clementstorne/Google Drive/OpenClassrooms/Dev-web/P7/groupomania-code/front/src/components/ProfileUpdate.vue"],"sourcesContent":["<template>\n  <div class=\"profile container py-3 px-3 col-12 py-md-3 px-md-5 col-md-10\">\n    <div class=\"profile-username text-center\">\n      <h2>{{ user.firstname }} {{ user.lastname }}</h2>\n    </div>\n    <div\n      class=\"profile-picture d-flex flex-column justify-content-center align-items-center mt-3 mb-5\"\n    >\n      <img\n        :src=\"imageBase64url\"\n        alt=\"Photo de profil de l'utilisateur\"\n        v-if=\"imageBase64url\"\n      />\n      <img\n        :src=\"user.imageUrl\"\n        alt=\"Photo de profil de l'utilisateur\"\n        v-else-if=\"user.imageUrl\"\n      />\n      <img\n        :src=\"defautlImageUrl\"\n        alt=\"Photo de profil de l'utilisateur\"\n        v-else\n      />\n      <div class=\"profile-picture-btn col-10 text-center\">\n        <input\n          type=\"file\"\n          name=\"image\"\n          id=\"profilePicture\"\n          accept=\"image/png, image/jpg, image/jpeg\"\n          class=\"profile-picture-btn-input\"\n          @change=\"setBase64urlImage\"\n        />\n        <button class=\"btn btn-primary col-12 mt-3\">\n          <label for=\"profilePicture\">Modifier la photo de profil</label>\n        </button>\n      </div>\n    </div>\n    <div class=\"profile-email mb-5 text-center\">\n      <div class=\"mb-2\">\n        <label for=\"email\" class=\"form-label\"\n          ><span v-if=\"!emailIsValid\" class=\"form-alert\" @click=\"emailAlert\">\n            ⚠️ </span\n          ><span v-else> ✅ </span>Email</label\n        >\n        <input\n          type=\"email\"\n          class=\"form-control\"\n          id=\"email\"\n          :placeholder=\"user.email\"\n          v-model=\"user.email\"\n        />\n      </div>\n    </div>\n    <div class=\"profile-password mb-5 text-center\">\n      <div class=\"mb-2\">\n        <label for=\"password\" class=\"form-label\"\n          ><span\n            v-if=\"!passwordIsValid\"\n            class=\"form-alert\"\n            @click=\"passwordAlert\"\n          >\n            ⚠️ </span\n          ><span v-else> ✅ </span>Mot de passe</label\n        >\n        <input\n          type=\"password\"\n          class=\"form-control\"\n          id=\"password\"\n          placeholder=\"********\"\n          v-model=\"user.password\"\n        />\n      </div>\n    </div>\n\n    <button\n      class=\"btn btn-primary col-12 mb-3\"\n      @click=\"updateProfile\"\n      :disabled=\"!formIsValid\"\n    >\n      Mettre à jour les informations\n    </button>\n\n    <div class=\"profile-delete mb-2\">\n      <button class=\"btn btn-secondary col-12\" @click=\"showBlockConfirmation\">\n        Supprimer le compte\n      </button>\n    </div>\n\n    <BlockAlert\n      :revealAlert=\"revealAlert\"\n      :toggleAlert=\"toggleAlert\"\n      :messageAlert=\"messageAlert\"\n    />\n    <BlockConfirmation\n      :revealConfirmation=\"revealConfirmation\"\n      :toggleConfirmation=\"toggleConfirmation\"\n      :messageConfirmation=\"messageConfirmation\"\n      @action=\"deleteProfile\"\n    />\n  </div>\n</template>\n\n<script>\nimport BlockAlert from \"@/components/BlockAlert.vue\";\nimport BlockConfirmation from \"@/components/BlockConfirmation.vue\";\n\nimport { UsersService } from \"@/services/UsersService\";\nimport profilePicture from \"@/assets/user-profile-picture.png\";\n\nexport default {\n  name: \"ProfileUpdate\",\n  components: {\n    BlockAlert,\n    BlockConfirmation,\n  },\n  data() {\n    return {\n      user: {\n        id: 0,\n        firstname: \"\",\n        lastname: \"\",\n        email: \"\",\n        password: \"\",\n        imageUrl: \"\",\n      },\n      imageBase64url: \"\",\n      defautlImageUrl: profilePicture,\n      imageFile: null,\n      revealAlert: false,\n      messageAlert: \"\",\n      revealConfirmation: false,\n      messageConfirmation: \"\",\n    };\n  },\n  computed: {\n    emailIsValid() {\n      let regex = /^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$/;\n      return regex.test(this.user.email);\n    },\n    passwordIsValid() {\n      let regex = /((?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\\W]).{8,})/g;\n      return regex.test(this.user.password);\n    },\n    formIsValid() {\n      return (\n        (this.user.email && this.emailIsValid) ||\n        this.imageFile ||\n        (this.user.password && this.passwordIsValid)\n      );\n    },\n  },\n  beforeMount() {\n    UsersService.getUserData()\n      .then((res) => {\n        this.user = res.data.data;\n      })\n      .catch((err) => console.log(err));\n  },\n  methods: {\n    setBase64urlImage(e) {\n      this.imageFile = e.target.files[0];\n      const fileReader = new FileReader();\n      fileReader.readAsDataURL(this.imageFile);\n      fileReader.addEventListener(\"load\", () => {\n        this.imageBase64url = fileReader.result;\n      });\n    },\n    updateProfile() {\n      const formData = new FormData();\n      if (this.imageFile) {\n        formData.append(\"image\", this.imageFile);\n      }\n      if (this.user.email) {\n        formData.append(\"email\", this.user.email);\n      }\n      if (this.user.password) {\n        formData.append(\"password\", this.user.password);\n      }\n      UsersService.updateProfile(formData, this.user.id);\n      this.messageAlert = \"Le profil a été mis à jour\";\n      this.revealAlert = !this.revealAlert;\n    },\n    toggleAlert() {\n      this.revealAlert = !this.revealAlert;\n    },\n    showBlockConfirmation() {\n      this.messageConfirmation =\n        \"Êtes-vous sûr de vouloir supprimer votre profil ?\";\n      this.revealConfirmation = !this.revealConfirmation;\n    },\n    emailAlert() {\n      this.messageAlert = \"Adresse email incorrecte\";\n      this.revealAlert = !this.revealAlert;\n    },\n    passwordAlert() {\n      this.messageAlert =\n        \"Le mot de passe doit contenir au moins une majuscule, une minuscule, un chiffre et un caractère spécial. Il doit avoir une longueur minimale de 8 caractères\";\n      this.revealAlert = !this.revealAlert;\n    },\n    deleteProfile() {\n      UsersService.deleteProfile(this.user.id);\n      this.$router.push(\"/\");\n    },\n    toggleConfirmation() {\n      this.revealConfirmation = !this.revealConfirmation;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.profile {\n  background-color: $white !important;\n  border-radius: 16px;\n  &-picture {\n    & img {\n      width: 150px;\n      height: 150px;\n      object-fit: cover;\n      border-radius: 50%;\n    }\n    &-btn {\n      position: relative;\n      overflow: hidden;\n      &-input {\n        position: absolute;\n        font-size: 50px;\n        opacity: 0;\n        right: 0;\n        top: 0;\n        bottom: 0;\n        left: 0;\n      }\n    }\n  }\n}\n.form {\n  &-label {\n    font-size: 16px;\n    font-weight: 400;\n    font-weight: 500;\n  }\n  &-control {\n    border: none;\n    padding: 12px;\n    background: $gray;\n    &:focus {\n      box-shadow: 0px 0px 0px 4px rgba($color-primary, 0.5);\n      outline: none;\n    }\n  }\n  &-alert {\n    cursor: pointer;\n  }\n}\n.btn {\n  font-weight: 700;\n  font-size: 16px;\n  border-radius: 8px;\n  border: none;\n  &-primary {\n    background: $color-tertiary;\n    &:hover {\n      background: darken($color-tertiary, 5%);\n    }\n    &:focus {\n      background: darken($color-tertiary, 5%);\n      box-shadow: 0px 0px 0px 4px rgba($color-tertiary, 0.5);\n      outline: none;\n    }\n    &:disabled {\n      background: $dark-gray;\n      outline: none;\n    }\n  }\n  &-secondary {\n    background: $color-primary;\n    &:hover {\n      background: darken($color-primary, 5%);\n    }\n    &:focus {\n      background: darken($color-primary, 5%);\n      box-shadow: 0px 0px 0px 4px rgba($color-primary, 0.5);\n      outline: none;\n    }\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}