{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-429ff339\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"post-update\"\n};\nconst _hoisted_2 = {\n  class: \"post-update-card card px-1 pt-5 pb-2 px-md-5 mb-md-5\"\n};\nconst _hoisted_3 = {\n  class: \"post-update-content ms-2 me-2\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = {\n  class: \"post-update-buttons row d-flex flex-column align-items-between flex-md-row justify-content-start align-items-md-start py-2\"\n};\nconst _hoisted_7 = {\n  class: \"post-update-buttons-picture col-12 col-md-6 d-grid mb-2 p-0\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"btn btn-secondary mx-1\"\n};\n\nconst _hoisted_9 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"media\"\n}, \"üì∑ Modifier la photo\", -1\n/* HOISTED */\n));\n\nconst _hoisted_10 = [_hoisted_9];\nconst _hoisted_11 = {\n  key: 1,\n  class: \"btn btn-secondary mx-1\"\n};\n\nconst _hoisted_12 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"media\"\n}, \"üì∑ Ajouter une photo\", -1\n/* HOISTED */\n));\n\nconst _hoisted_13 = [_hoisted_12];\nconst _hoisted_14 = {\n  class: \"post-update-buttons-btn col-12 col-md-6 d-grid mb-2 p-0\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return $props.revealPostUpdate ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", {\n    class: \"post-update-overlay\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $props.togglePostUpdate && $props.togglePostUpdate(...args))\n  }), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", {\n    class: \"post-update-btn btn\",\n    onClick: _cache[1] || (_cache[1] = (...args) => $props.togglePostUpdate && $props.togglePostUpdate(...args))\n  }, \"‚úñÔ∏è\"), _createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createElementVNode(\"textarea\", {\n    class: \"post-update-textarea\",\n    placeholder: `Quoi de neuf ?`,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.post.content = $event),\n    style: {\n      \"height\": \"100px\"\n    },\n    id: \"post_content\"\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelText, $data.post.content]]), $data.imageBase64url ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 0,\n    src: $data.imageBase64url,\n    alt: \"\",\n    class: \"mt-3\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_4)) : $data.post.mediaUrl ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 1,\n    src: $data.post.mediaUrl,\n    alt: \"\",\n    class: \"post-img\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_5)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"input\", {\n    type: \"file\",\n    name: \"image\",\n    id: \"media\",\n    accept: \"image/png, image/jpg, image/jpeg image/gif\",\n    class: \"post-update-buttons-picture-btn-input\",\n    onChange: _cache[3] || (_cache[3] = (...args) => $options.setBase64urlImage && $options.setBase64urlImage(...args))\n  }, null, 32\n  /* HYDRATE_EVENTS */\n  ), this.post.mediaUrl ? (_openBlock(), _createElementBlock(\"button\", _hoisted_8, _hoisted_10)) : (_openBlock(), _createElementBlock(\"button\", _hoisted_11, _hoisted_13))]), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"button\", {\n    class: \"btn btn-primary mx-1\",\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.editPost && $options.editPost(...args))\n  }, \" Modifier le post \")])])])])) : _createCommentVNode(\"v-if\", true);\n}","map":{"version":3,"mappings":";;;;;;EACOA,KAAK,EAAC;;;EAEJA,KAAK,EAAC;;;EAEJA,KAAK,EAAC;;;;;EAiBTA,KAAK,EAAC;;;EAGJA,KAAK,EAAC;;;;EAUEA,KAAK,EAAC;;;gEACZC,oBAA+C,OAA/C,EAA+C;EAAxCC,GAAG,EAAC;AAAoC,CAA/C,EAAmB,sBAAnB,EAAuC;AAAA;AAAvC;;qBAAAC;;;EAEMH,KAAK,EAAC;;;iEACZC,oBAA+C,OAA/C,EAA+C;EAAxCC,GAAG,EAAC;AAAoC,CAA/C,EAAmB,sBAAnB,EAAuC;AAAA;AAAvC;;qBAAAE;;EAGCJ,KAAK,EAAC;;;SAzCcK,yCAA/BC,oBAgDM,KAhDN,cAgDM,CA/CJL,oBAAiE,KAAjE,EAAiE;IAA5DD,KAAK,EAAC,qBAAsD;IAA/BO,OAAK,yCAAEF,2DAAF;EAA0B,CAAjE,CA+CI,EA9CJJ,oBA6CM,KA7CN,cA6CM,CA5CJA,oBAAmE,KAAnE,EAAmE;IAA9DD,KAAK,EAAC,qBAAwD;IAAjCO,OAAK,yCAAEF,2DAAF;EAA4B,CAAnE,EAA2D,IAA3D,CA4CI,EA3CJJ,oBAeM,KAfN,cAeM,iBAdJA,oBAMY,UANZ,EAMY;IALVD,KAAK,EAAC,sBAKI;IAJTQ,WAAW,EAAE,gBAIJ;+DAHDC,WAAKC,UAAOC,OAGX;IAFVC,KAAqB,EAArB;MAAA;IAAA,CAEU;IADVC,EAAE,EAAC;EACO,CANZ;;EAAA,kBAGWJ,WAAKC,UAWZ,EAPoCD,sCAAxCH,oBAAuE,KAAvE,EAAuE;UAAA;IAAjEQ,GAAG,EAAEL,oBAA4D;IAA5CM,GAAG,EAAC,EAAwC;IAAff,KAAK,EAAC;EAAS,CAAvE;;EAAA,iBAIaS,WAAKO,0BAHlBV,oBAKE,KALF,EAKE;UAAA;IAJCQ,GAAG,EAAEL,WAAKO,QAIX;IAHAD,GAAG,EAAC,EAGJ;IADAf,KAAK,EAAC;EACN,CALF;;EAAA,kDAMI,CAfN,CA2CI,EA3BJC,oBA0BM,KA1BN,cA0BM,CAvBJA,oBAiBM,KAjBN,cAiBM,CAdJA,oBAOE,OAPF,EAOE;IANAgB,IAAI,EAAC,MAML;IALAC,IAAI,EAAC,OAKL;IAJAL,EAAE,EAAC,OAIH;IAHAM,MAAM,EAAC,4CAGP;IAFAnB,KAAK,EAAC,uCAEN;IADCoB,QAAM,yCAAEC,iEAAF;EACP,CAPF;;EAAA,CAcI,OAN8CC,KAAKN,0BAAvDV,oBAES,QAFT,cAESiB,WAFT,oBAGAjB,oBAES,QAFT,eAESkB,WAFT,EAGI,CAjBN,CAuBI,EALJvB,oBAIM,KAJN,eAIM,CAHJA,oBAES,QAFT,EAES;IAFDD,KAAK,EAAC,sBAEL;IAF6BO,OAAK,yCAAEc,+CAAF;EAElC,CAFT,EAAuD,oBAAvD,CAGI,CAJN,CAKI,CA1BN,CA2BI,CA7CN,CA8CI,CAhDN","names":["class","_createElementVNode","for","_hoisted_9","_hoisted_12","$props","_createElementBlock","onClick","placeholder","$data","content","$event","style","id","src","alt","mediaUrl","type","name","accept","onChange","$options","post","_hoisted_10","_hoisted_13"],"sourceRoot":"","sources":["/Users/clementstorne/Google Drive/OpenClassrooms/Dev-web/P7/groupomania-code/front/src/components/PostUpdate.vue"],"sourcesContent":["<template>\n  <div class=\"post-update\" v-if=\"revealPostUpdate\">\n    <div class=\"post-update-overlay\" @click=\"togglePostUpdate\"></div>\n    <div class=\"post-update-card card px-1 pt-5 pb-2 px-md-5 mb-md-5\">\n      <div class=\"post-update-btn btn\" @click=\"togglePostUpdate\">‚úñÔ∏è</div>\n      <div class=\"post-update-content ms-2 me-2\">\n        <textarea\n          class=\"post-update-textarea\"\n          :placeholder=\"`Quoi de neuf ?`\"\n          v-model=\"post.content\"\n          style=\"height: 100px\"\n          id=\"post_content\"\n        ></textarea>\n        <img :src=\"imageBase64url\" alt=\"\" v-if=\"imageBase64url\" class=\"mt-3\" />\n        <img\n          :src=\"post.mediaUrl\"\n          alt=\"\"\n          v-else-if=\"post.mediaUrl\"\n          class=\"post-img\"\n        />\n      </div>\n      <div\n        class=\"post-update-buttons row d-flex flex-column align-items-between flex-md-row justify-content-start align-items-md-start py-2\"\n      >\n        <div\n          class=\"post-update-buttons-picture col-12 col-md-6 d-grid mb-2 p-0\"\n        >\n          <input\n            type=\"file\"\n            name=\"image\"\n            id=\"media\"\n            accept=\"image/png, image/jpg, image/jpeg image/gif\"\n            class=\"post-update-buttons-picture-btn-input\"\n            @change=\"setBase64urlImage\"\n          />\n          <button class=\"btn btn-secondary mx-1\" v-if=\"this.post.mediaUrl\">\n            <label for=\"media\">üì∑ Modifier la photo</label>\n          </button>\n          <button class=\"btn btn-secondary mx-1\" v-else>\n            <label for=\"media\">üì∑ Ajouter une photo</label>\n          </button>\n        </div>\n        <div class=\"post-update-buttons-btn col-12 col-md-6 d-grid mb-2 p-0\">\n          <button class=\"btn btn-primary mx-1\" @click=\"editPost\">\n            Modifier le post\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { PostsService } from \"@/services/PostsService\";\n\nexport default {\n  name: \"PostUpdate\",\n  props: {\n    revealPostUpdate: Boolean,\n    togglePostUpdate: Function,\n    postId: Number,\n  },\n  data() {\n    return {\n      post: {\n        id: null,\n        content: \"\",\n        mediaUrl: null,\n      },\n      imageBase64url: \"\",\n      imageFile: null,\n    };\n  },\n  mounted() {\n    PostsService.getSinglePost(this.postId)\n      .then((res) => {\n        this.post = res.data.data;\n      })\n      .catch((err) => console.log(err));\n  },\n  methods: {\n    setBase64urlImage(e) {\n      this.imageFile = e.target.files[0];\n      const fileReader = new FileReader();\n      fileReader.readAsDataURL(this.imageFile);\n      fileReader.addEventListener(\"load\", () => {\n        this.imageBase64url = fileReader.result;\n      });\n    },\n    async editPost() {\n      try {\n        const formData = new FormData();\n        if (this.imageFile) {\n          formData.append(\"image\", this.imageFile);\n        }\n        formData.append(\"content\", this.post.content);\n        const postId = this.post.id;\n        const result = await PostsService.editPost(postId, formData);\n        this.$emit(\"postUpdated\", result.data.updatedPost);\n      } catch (err) {\n        console.log(err);\n      }\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.post-update {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-weight: 700;\n  font-size: 16px;\n  &-overlay {\n    background: rgba(0, 0, 0, 0.5);\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n  }\n  &-card {\n    border-left: 8px solid $color-primary;\n    width: 90%;\n    border-radius: 8px;\n  }\n  &-btn {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    border-radius: 8px;\n  }\n  &-text {\n    text-align: center;\n  }\n  &-content {\n    text-align: center;\n    & img {\n      max-width: 100%;\n    }\n  }\n  &-textarea {\n    border-radius: 16px;\n    padding: 8px 16px;\n    background: $gray;\n    border: none;\n    resize: none;\n    width: 100%;\n    &:focus {\n      box-shadow: 0px 0px 0px 4px rgba($color-primary, 0.5);\n      outline: none;\n    }\n  }\n  &-buttons {\n    color: $dark-gray;\n    font-weight: 600;\n    align-items: center;\n    margin: 0;\n    &-picture {\n      position: relative;\n      overflow: hidden;\n      &:hover {\n        color: $color-primary;\n        font-weight: 900;\n        cursor: pointer;\n      }\n      &-btn-input {\n        position: absolute;\n        font-size: 50px;\n        opacity: 0;\n        right: 0;\n        top: 0;\n        bottom: 0;\n        left: 0;\n      }\n      & p {\n        margin-bottom: 0;\n      }\n    }\n  }\n}\n.btn {\n  font-weight: 700;\n  font-size: 16px;\n  border-radius: 8px;\n  border: none;\n  &-primary {\n    background: $color-primary;\n    &:hover {\n      background: darken($color-primary, 5%);\n    }\n    &:focus {\n      background: darken($color-primary, 5%);\n      box-shadow: 0px 0px 0px 4px rgba($color-primary, 0.5);\n      outline: none;\n    }\n  }\n  &-secondary {\n    background: $color-tertiary;\n    &:hover {\n      background: darken($color-tertiary, 5%);\n    }\n    &:focus {\n      background: darken($color-tertiary, 5%);\n      box-shadow: 0px 0px 0px 4px rgba($color-tertiary, 0.5);\n      outline: none;\n    }\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}